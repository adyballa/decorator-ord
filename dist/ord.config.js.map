{"version":3,"file":"ord.config.js","sourceRoot":"","sources":["../ord.config.ts"],"names":[],"mappings":"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","sourcesContent":["import {EqField, EqConfig} from \"decorator-eq\";\r\nimport {IField, TFieldValue} from \"decorator-eq/eq.interface\";\r\nimport {IOrd, isOrd, TDirection, IOrdFieldProperty, IOrdField, isFieldOrd, IOrdConfig} from \"./ord.interface\";\r\n\r\nexport class Field extends EqField implements IOrdField {\r\n\r\n    public dir:TDirection;\r\n\r\n    public map:Array<string>;\r\n\r\n    constructor(public name:string, props:IOrdFieldProperty) {\r\n        super(name);\r\n        this.map = ('map' in props) ? props.map : [];\r\n        this.dir = ('dir' in props) ? props.dir : \"ASC\"\r\n    }\r\n\r\n    public greater(a:IOrd, b:IOrd):boolean {\r\n        let vals = [this.value(a), this.value(b)];\r\n        if (vals[0] === null || vals[1] === null || vals[0] === vals[1]) {\r\n            return null;\r\n        } else {\r\n            if (isOrd(vals[0])) {\r\n                return (this.dir == \"ASC\") ? (<IOrd> vals[0]).greater(<IOrd> vals[1]) : (<IOrd> vals[0]).less(<IOrd> vals[1]);\r\n            } else {\r\n                return (this.dir == \"ASC\") ? (vals[0] > vals[1]) : (vals[0] < vals[1]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public less(a:IOrd, b:IOrd):boolean {\r\n        let vals = [this.value(a), this.value(b)];\r\n        if (vals[0] === null || vals[1] === null || vals[0] === vals[1]) {\r\n            return null;\r\n        } else {\r\n            if (isOrd(vals[0])) {\r\n                return (this.dir == \"ASC\") ? (<IOrd> vals[0]).less(b) : (<IOrd> vals[0]).greater(b);\r\n            } else {\r\n                return (this.dir == \"ASC\") ? (vals[0] < vals[1]) : (vals[0] > vals[1]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public value(object:IOrd):TFieldValue {\r\n        let val = object[this.name];\r\n        if (val === null) {\r\n            return null;\r\n        }\r\n        if (this.map.length) {\r\n            return this.map.indexOf(object[this.name]);\r\n        } else {\r\n            return super.value(object);\r\n        }\r\n    }\r\n\r\n    public clone():Field {\r\n        return new Field(this.name, {map: this.map, dir: this.dir, ordinality: -2});\r\n    }\r\n}\r\n\r\nexport class OrdConfig extends EqConfig implements IOrdConfig {\r\n\r\n    protected _ordFields:Array<IOrdField> = [];\r\n\r\n    public clone():OrdConfig {\r\n        const res = new OrdConfig();\r\n        let f : Array<IField> = [];\r\n        this.fields.forEach((field:IField) =>{\r\n            f.push(field.clone());\r\n        });\r\n        res.fields=f;\r\n        return res;\r\n    }\r\n\r\n    public set fields(fields:Array<IField>) {\r\n        this._fields = [];\r\n        this._ordFields = [];\r\n        fields.forEach((field:IField) => {\r\n            if (isFieldOrd(field)) {\r\n                this._ordFields.push(<IOrdField> field);\r\n            }else{\r\n                this._fields.push(field);\r\n            }\r\n        });\r\n    }\r\n\r\n    public get fields():Array<IField> {\r\n        return (<IField[]> this._ordFields).concat(this._fields);\r\n    }\r\n\r\n    public get eqFields():Array<EqField> {\r\n        return this._fields;\r\n    }\r\n\r\n    public get ordFields():Array<IOrdField> {\r\n        return this._ordFields;\r\n    }\r\n\r\n    public static setOrdinalityOfField(name:string, fields:Array<IField>, newIndex = 0) {\r\n        let oldKey = fields.findIndex((field:IField) => {\r\n            return (field.name === name);\r\n        });\r\n        fields.splice(newIndex, 0, fields.splice(oldKey, 1)[0]);\r\n    }\r\n}\r\n"]}