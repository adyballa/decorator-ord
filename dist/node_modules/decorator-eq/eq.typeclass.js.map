{"version":3,"file":"eq.typeclass.js","sourceRoot":"","sources":["../../../node_modules/decorator-eq/eq.typeclass.ts"],"names":[],"mappings":"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","sourcesContent":["import {IEq, isEq, IEqConfig, IField, IEqProps, IFieldProperty} from \"./eq.interface\";\nimport {EqField} from \"./eq.config\";\n\nexport class FuzzyEqField extends EqField {\n\n    public eq(a:IEq, b:IEq):boolean {\n        let vals = [this.value(a), this.value(b)];\n        if (vals[0] === null || vals[1] === null) {\n            return null;\n        } else {\n            if (isEq(vals[0])) {\n                return (<IEq> vals[0]).eq(<IEq> vals[1])\n            } else {\n                if (vals[0] === vals[1]) {\n                    return true;\n                } else {\n                    return ((typeof vals[0] === \"string\") && ((<string> vals[1]).indexOf(<string> vals[0]) > -1)) ? null : false;\n                }\n            }\n        }\n    }\n}\n\nexport class Eq {\n\n    protected static _eq:{fields:Array<EqField>} = {fields: []};\n\n    protected static _impl(method:string) {\n        return function (a:any, config?:IEqConfig) {\n            let res:boolean = null;\n            if (!config) {\n                throw new Error(\"Method \" + method + \" cannot be run without config.\");\n            }\n            for (let field of config.fields) {\n                let val:boolean = (method === \"eq\") ? field.eq(this, a) : field.neq(this, a);\n                if (val !== null) {\n                    if (!val) return false;\n                    res = true;\n                }\n            }\n            return res;\n        }\n    }\n\n    static implementFields(config?:IEqConfig, fields:Array<IField> = []) {\n        let _f:Array<IField> = [];\n        for (let i = 0, j = fields.length; i < j; i++) {\n            if (fields[i] !== undefined) {\n                _f.push(fields[i]);\n            }\n        }\n        if (config) {\n            config.fields = _f;\n        }\n    }\n\n    static field(props:IFieldProperty) {\n        return function (target:Object, propertyKey:string) {\n            Eq._eq.fields.push((\"fuzzy\" in props && props.fuzzy) ? new FuzzyEqField(propertyKey) : new EqField(propertyKey));\n        }\n    }\n\n    static implement(props?:IEqProps) {\n        return (target:Function) => {\n            Eq.implementFields((props) ? props.config : null, Eq._eq.fields);\n            Eq._eq.fields = [];\n            target.prototype.eq = this._impl(\"eq\");\n            target.prototype.neq = this._impl(\"neq\");\n        }\n    }\n\n    static eq(cs:IEq[], ref:IEq, config:IEqConfig):IEq[] {\n        return cs.filter((a:IEq) => {\n            return ref.eq(a, config);\n        });\n    }\n\n    static fuzzyEq(cs:IEq[], ref:IEq, config:IEqConfig):IEq[] {\n        return cs.filter((a:IEq) => {\n            return (ref.eq(a, config) !== false);\n        });\n    }\n\n    static neq(cs:IEq[], ref:IEq, config:IEqConfig):IEq[] {\n        return cs.filter((a:IEq) => {\n            return (ref.eq(a, config) === false);\n        });\n    }\n}\n"]}